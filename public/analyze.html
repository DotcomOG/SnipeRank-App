<!--
  Version: 1.9.7
  Last Updated: Aug 08, 2025
  Changes:
  - Edit ONLY ranking UI: replace gauge with compact score card
  - Restore prior report text spacing
  - High-contrast methodology button; keep lightbox behavior unchanged
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SnipeRank — AI SEO Analysis Results</title>
  <style>
    :root {
      --max-width: 760px;
      --pad-v: 3vh;
      --pad-h: 2rem;
    }

    body {
      font-family: Helvetica, sans-serif;
      background: #fff;
      color: #000;
      margin: 0;
      padding: var(--pad-v) var(--pad-h);
      max-width: var(--max-width);
      margin-left: auto;
      margin-right: auto;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    h1 {
      font-size: 4rem;
      font-weight: 700;
      margin: 0 0 0.25em 0;
      line-height: 1;
      letter-spacing: -1px;
    }

    h2 {
      font-size: 1.5rem;
      font-weight: 400;
      margin: 0 0 2rem 0;
    }

    h3 {
      font-size: 1.2rem;
      font-weight: 500;
      margin: 2rem 0 1rem 0;
    }

    /* Restore original readable copy spacing */
    p {
      font-size: 1.1rem;
      line-height: 1.75;
      margin-bottom: 1rem;
    }

    #analyzed-url {
      text-align: center;
      margin-bottom: 1rem;
      color: #666;
    }

    #current-url {
      color: #000;
      font-weight: 500;
    }

    #summary-results {
      width: 100%;
      margin: 2rem 0;
      padding: 0;
      background: none;
      border: none;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 3rem 0 1.5rem 0;
      color: #000;
      letter-spacing: -0.5px;
      padding-bottom: 0.75rem;
      position: relative;
    }

    .insights-marker {
      display: inline-block;
      width: 4px;
      height: 1.2rem;
      background: linear-gradient(45deg, #3182CE 0%, #2B6CB0 100%);
      margin-right: 0.75rem;
      vertical-align: text-top;
      margin-top: 0.1rem;
      border-radius: 2px;
    }

    .opportunity-marker {
      display: inline-block;
      width: 0;
      height: 0;
      border-left: 8px solid #E53E3E;
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
      margin-right: 0.75rem;
      margin-top: 0.3rem;
      vertical-align: text-top;
    }

    .strength-marker {
      display: inline-block;
      width: 10px;
      height: 10px;
      background: linear-gradient(45deg, #38A169 0%, #2F855A 100%);
      border-radius: 50%;
      margin-right: 0.75rem;
      margin-top: 0.35rem;
      vertical-align: text-top;
      box-shadow: 0 1px 3px rgba(56, 161, 105, 0.3);
    }

    ul {
      margin: 0 0 2rem 0;
      padding-left: 0;
      list-style: none;
    }

    li {
      margin-bottom: 1.5rem;
      line-height: 1.75;
      padding-left: 0;
      font-size: 1.1rem;
    }

    li strong {
      font-weight: 600;
      color: #000;
    }

    .new-analysis-section {
      text-align: center;
      margin: 2rem 0;
      padding: 1rem;
      width: 100%;
    }

    .new-analysis-form {
      display: flex;
      gap: 1rem;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .new-analysis-form input {
      flex: 1;
      max-width: 400px;
      min-width: 250px;
    }

    .consultation-section {
      width: 100%;
      margin-top: 3rem;
      border-top: 1px solid #ddd;
      padding-top: 2rem;
      text-align: center;
    }

    .consultation-cta {
      margin: 2rem 0;
    }

    .schedule-button {
      display: inline-block;
      background: linear-gradient(135deg, #E53E3E 0%, #C53030 100%);
      color: white;
      padding: 1rem 2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(229, 62, 62, 0.3);
    }

    .schedule-button:hover {
      background: linear-gradient(135deg, #C53030 0%, #9C2A2A 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(229, 62, 62, 0.4);
    }

    input, textarea {
      font-size: 1.05rem;
      padding: 0.8rem 1rem;
      border: 1px solid #000;
      width: 100%;
      background: transparent;
      box-sizing: border-box;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    button {
      font-size: 1rem;
      font-weight: 500;
      padding: 0.8rem 1.5rem;
      border: none;
      color: #fff;
      background: #000;
      cursor: pointer;
      margin-top: 1rem;
    }

    button:hover {
      background: #333;
    }

    .form-button-wrapper {
      text-align: center;
      margin-top: 1.5rem;
    }

    #formMessage {
      text-align: center;
      margin-top: 1rem;
      font-weight: 500;
    }

    .footer {
      font-size: 0.85rem;
      color: #666;
      margin-top: 3rem;
      text-align: center;
      width: 100%;
    }

    /* --- New compact score card (replaces gauge) --- */
    .score-card{
      width:100%;
      border:1px solid #e5e5e5;
      border-radius:12px;
      padding:1rem;
      box-shadow:0 1px 2px rgba(0,0,0,.04);
      margin-bottom:1rem;
    }
    .score-top{
      display:flex; align-items:center; gap:1rem; justify-content:space-between; flex-wrap:wrap;
    }
    .score-main{
      display:flex; align-items:baseline; gap:.5rem;
    }
    .score-number{
      font-size:2.25rem; font-weight:800;
    }
    .score-band{ color:#666; font-size:.95rem; }

    /* High-contrast methodology button inside score box */
    .methodology-btn{
      border:1px solid #111;
      background:#fff;
      color:#111;
      padding:.55rem .9rem;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      font-size:.95rem;
    }
    .methodology-btn:hover{ background:#f2f2f2; }

    .pillars{
      display:grid; grid-template-columns: 1fr 1fr; gap:.75rem; margin-top:.75rem;
    }
    .pillar{
      border:1px solid #e5e5e5; border-radius:10px; padding:.6rem .75rem;
      display:flex; align-items:center; justify-content:space-between;
      font-size:.98rem;
    }
    .pillar .label{ font-weight:600; }
    .badge{
      font-weight:700; padding:.2rem .5rem; border-radius:999px; border:1px solid #e5e5e5;
      font-size:.85rem; background:#fafafa;
    }

    .highlights{
      margin-top:.75rem; padding-top:.75rem; border-top:1px dashed #e5e5e5;
    }
    .highlights h4{
      margin:0 0 .4rem 0; font-size:1rem;
    }
    .highlights ul{ margin:0; padding-left:1rem; }
    .highlights li{ margin:.25rem 0; line-height:1.5; }

    /* Modal (lightbox) — keep behavior, just ensure visible close) */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(0,0,0,.45);
      display:none; align-items:center; justify-content:center; z-index:50;
    }
    .modal{
      width:min(600px, 92vw); background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.25);
      padding:1.1rem; position:relative;
    }
    .modal-close{
      position:absolute; top:.35rem; right:.5rem; border:none; background:transparent;
      font-size:1.6rem; line-height:1; cursor:pointer; color:#222;
    }

    @media (max-width: 600px) {
      .new-analysis-form { flex-direction: column; }
      .new-analysis-form input { max-width: 100%; }
      .pillars{ grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <h1>SnipeRank</h1>
  <h2>AI SEO Analysis Results</h2>

  <!-- Compact Score Card (replaces the old gauge) -->
  <section class="score-card" id="scoreCard" aria-live="polite">
    <div class="score-top">
      <div class="score-main">
        <div class="score-number" id="scoreNumber">—</div>
        <div class="score-band" id="scoreBand">Calculating…</div>
      </div>
      <button class="methodology-btn" id="methodologyBtn" type="button">View Scoring Methodology</button>
    </div>

    <div class="pillars" id="pillarsGrid"></div>

    <div class="highlights" id="highlightsBlock" hidden>
      <h4>Highlights</h4>
      <ul id="highlightsList"></ul>
    </div>
  </section>

  <p style="color: #666; font-size: 0.9rem; margin-top: 0.5rem;">
    Powered by <a href="https://quontora.com" target="_blank" style="color: #3182CE; text-decoration: none; font-weight: 500;">quontora</a>
  </p>

  <div id="analyzed-url" style="margin-bottom: 0.5rem;">
    <p style="margin: 0; font-size: 1rem;">Analysis for: <strong id="current-url"></strong></p>
  </div>

  <!-- Dynamic summary from backend -->
  <section id="summary-results">
    <p style="text-align: center; color: gray;">Loading analysis...</p>
  </section>

  <section class="consultation-section">
    <h3>Get Your Full Report</h3>
    <form id="fullReportForm">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <input type="text" name="name" placeholder="Your Name" required autocomplete="name" />
        <input type="email" name="email" placeholder="Your Email" required autocomplete="email" />
        <input type="tel" name="phone" placeholder="Your Phone (optional)" autocomplete="tel" />
        <input type="text" name="company" placeholder="Your Company (optional)" autocomplete="organization" />
      </div>

      <textarea
        name="message"
        placeholder="Share context or ask a specific question — we’ll address at your free consult."
        rows="3"
        style="width: 100%; margin-top: 1rem;"
      ></textarea>

      <input type="hidden" name="url" id="urlField" />

      <div class="form-button-wrapper">
        <button type="submit">Email Me My Full Report</button>
      </div>

      <p id="formMessage" style="text-align: center; font-size: 0.95rem; color: gray;"></p>
    </form>
  </section>

  <section class="consultation-section">
    <h3>Ready to Improve Your AI Visibility?</h3>
    <p>After reviewing your analysis, book a free 30-minute consultation to discuss your specific opportunities and next steps.</p>
    <div class="consultation-cta">
      <a href="https://calendly.com/quontora" id="scheduleBtn" class="schedule-button" target="_blank">
        Schedule Free Consultation
      </a>
    </div>
    <p class="consultation-note">
      <strong>What we'll cover:</strong> Your AI SEO opportunities, implementation timeline, and how to get found by ChatGPT, Gemini, and other AI platforms.
    </p>
  </section>

  <div class="footer">&copy; 2025 SnipeRank by <a href="https://quontora.com" target="_blank" style="color: #3182CE; text-decoration: none;">quontora.com</a>. Last updated August 8.</div>

  <!-- Lightbox (kept) -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal">
      <button class="modal-close" id="modalClose" aria-label="Close">×</button>
      <h3 id="modalTitle">SnipeRank Scoring Methodology</h3>
      <p>Our proprietary model evaluates four pillars. Exact weights are confidential.</p>
      <ul>
        <li>Structural access and discoverability signals.</li>
        <li>Trust and verification footprints across sources.</li>
        <li>Clarity and interpretability for LLMs.</li>
        <li>Prompt-pattern alignment and response framing.</li>
      </ul>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const urlParams = new URLSearchParams(window.location.search);
      const targetUrl = urlParams.get("url") || "https://example.com";
      document.getElementById("current-url").textContent = targetUrl;

      // Load dynamic AI analysis results (unchanged)
      try {
        const res = await fetch(`https://sniperank-app2.onrender.com/report.html?url=${encodeURIComponent(targetUrl)}`);
        const html = await res.text();
        document.getElementById("summary-results").innerHTML = html;
      } catch (err) {
        console.error("Error loading analysis:", err);
        document.getElementById("summary-results").innerHTML =
          "<p style='color:red; text-align:center;'>Error loading analysis</p>";
      }

      // --- V1 Scoring (frontend only; replace with backend when ready) ---
      const { total, pillars, highlights } = calculateScoreV1();
      renderScoreCard(total, pillars, highlights);

      // Full Report form (unchanged)
      const form = document.getElementById("fullReportForm");
      if (form && targetUrl) {
        document.getElementById("urlField").value = targetUrl;

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          const status = document.getElementById("formMessage");
          status.textContent = "📤 Sending...";

          const payload = {
            name: form.name.value,
            email: form.email.value,
            phone: form.phone.value,
            company: form.company.value,
            message: form.message.value,
            url: form.url.value,
          };

          try {
            const res = await fetch("https://sniperank-app2.onrender.com/api/send-link", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload),
            });

            const result = await res.json();
            if (result.success) {
              const reportUrl = `https://sniperank-app.vercel.app/full-report.html?url=${encodeURIComponent(payload.url)}`;
              window.location.href = reportUrl;
            } else {
              status.textContent = "❌ Something went wrong. Please try again.";
            }
          } catch (err) {
            console.error(err);
            status.textContent = "❌ Server error. Try again later.";
          }
        });
      }

      // Lightbox controls (kept)
      const openBtn = document.getElementById("methodologyBtn");
      const closeBtn = document.getElementById("modalClose");
      const backdrop = document.getElementById("modalBackdrop");
      openBtn.addEventListener("click", () => { backdrop.style.display = "flex"; });
      closeBtn.addEventListener("click", () => { backdrop.style.display = "none"; });
      backdrop.addEventListener("click", (e) => { if (e.target === backdrop) backdrop.style.display = "none"; });
      document.addEventListener("keydown", (e) => { if (e.key === "Escape") backdrop.style.display = "none"; });

      // ---------- Helpers ----------
      function calculateScoreV1(){
        const pillars = {
          access: 18 + Math.floor(Math.random() * 7),      // 18–24
          trust: 16 + Math.floor(Math.random() * 9),       // 16–24
          clarity: 19 + Math.floor(Math.random() * 6),     // 19–24
          alignment: 17 + Math.floor(Math.random() * 8)    // 17–24
        };
        const total = pillars.access + pillars.trust + pillars.clarity + pillars.alignment;

        const pool = [
          "Strong org identity; authorship verified.",
          "Add concise FAQ aligned to 'how/compare' prompts.",
          "Tighten headings toward a single core claim.",
          "Prefer lists/Q&A where possible for AI summarization.",
          "Add entity clarifiers (dates, roles, locations).",
          "Ensure consistent schema coverage across key pages."
        ];
        const highlights = shuffle(pool).slice(0,3);
        return { total, pillars, highlights };
      }

      function renderScoreCard(total, pillars, highlights){
        document.getElementById("scoreNumber").textContent = `${total}/100`;
        document.getElementById("scoreBand").textContent = bandText(total);

        const grid = document.getElementById("pillarsGrid");
        grid.innerHTML = "";
        const items = [
          ["AI Access Readiness", pillars.access],
          ["Trust & Verification Signals", pillars.trust],
          ["LLM Interpretability & Clarity", pillars.clarity],
          ["Prompt‑Pattern Alignment", pillars.alignment],
        ];
        for (const [label, val] of items){
          const div = document.createElement("div");
          div.className = "pillar";
          div.innerHTML = `<span class="label">${label}</span><span class="badge">${val}/25</span>`;
          grid.appendChild(div);
        }

        if (highlights?.length){
          const list = document.getElementById("highlightsList");
          list.innerHTML = "";
          highlights.forEach(h => { const li = document.createElement("li"); li.textContent = h; list.appendChild(li); });
          document.getElementById("highlightsBlock").hidden = false;
        }
      }

      function bandText(score){
        if (score >= 85) return "Rank: Highly Visible ★★★★☆";
        if (score >= 70) return "Rank: Partially Visible ★★★☆☆";
        if (score >= 55) return "Rank: Needs Work ★★☆☆☆";
        return "Rank: Low Visibility ★☆☆☆☆";
      }

      function shuffle(arr){
        const a = arr.slice();
        for (let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
        return a;
      }
    });
  </script>
</body>
</html>
